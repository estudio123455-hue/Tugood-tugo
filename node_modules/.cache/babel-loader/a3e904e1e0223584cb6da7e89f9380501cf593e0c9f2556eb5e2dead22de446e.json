{"ast":null,"code":"import _objectSpread from\"C:/Users/PERSONAL/Downloads/tugood tugo/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{Plus,Clock,Users,Calendar,Edit,Trash2,Eye,EyeOff}from'lucide-react';import{authAPI}from'../services/api';import'../styles/MerchantSlots.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MerchantSlots=_ref=>{let{user,onLogout}=_ref;const navigate=useNavigate();const[slots,setSlots]=useState([]);const[loading,setLoading]=useState(true);const[showCreateForm,setShowCreateForm]=useState(false);const[formData,setFormData]=useState({titulo:'',descripcion:'',fecha:'',hora_inicio:'',hora_fin:'',capacidad:1,precio_descuento:0});useEffect(()=>{loadSlots();},[]);const loadSlots=async()=>{try{setLoading(true);const response=await fetch(\"\".concat(process.env.REACT_APP_API_URL||'http://localhost:5000',\"/api/slots?comercio_id=\").concat(user.comercio_id),{headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('tugood_token'))}});if(response.ok){const data=await response.json();setSlots(data.slots||[]);}}catch(error){console.error('Error cargando slots:',error);}finally{setLoading(false);}};const handleCreateSlot=async e=>{e.preventDefault();try{const response=await fetch(\"\".concat(process.env.REACT_APP_API_URL||'http://localhost:5000',\"/api/slots\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('tugood_token'))},body:JSON.stringify(formData)});if(response.ok){const data=await response.json();setSlots([data.slot,...slots]);setShowCreateForm(false);setFormData({titulo:'',descripcion:'',fecha:'',hora_inicio:'',hora_fin:'',capacidad:1,precio_descuento:0});}}catch(error){console.error('Error creando slot:',error);}};const handleCloseSlot=async slotId=>{try{const response=await fetch(\"\".concat(process.env.REACT_APP_API_URL||'http://localhost:5000',\"/api/slots/\").concat(slotId,\"/cerrar\"),{method:'PUT',headers:{'Authorization':\"Bearer \".concat(localStorage.getItem('tugood_token'))}});if(response.ok){loadSlots();}}catch(error){console.error('Error cerrando slot:',error);}};const formatDate=dateStr=>{return new Date(dateStr).toLocaleDateString('es-CO');};const formatTime=timeStr=>{return timeStr.substring(0,5);};const getStatusColor=slot=>{if(!slot.activo)return'#ef4444';if(slot.disponible===0)return'#f59e0b';return'#10b981';};const getStatusText=slot=>{if(!slot.activo)return'Cerrado';if(slot.disponible===0)return'Agotado';return'Disponible';};return/*#__PURE__*/_jsxs(\"div\",{className:\"merchant-slots\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"slots-header\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"header-content\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-btn\",onClick:()=>navigate('/merchant-panel'),children:\"\\u2190 Volver\"}),/*#__PURE__*/_jsx(\"h1\",{children:\"Franjas Horarias\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"create-btn\",onClick:()=>setShowCreateForm(true),children:[/*#__PURE__*/_jsx(Plus,{size:20}),\"Nueva Franja\"]})]})}),showCreateForm&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"modal-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Crear Nueva Franja Horaria\"}),/*#__PURE__*/_jsx(\"button\",{className:\"close-btn\",onClick:()=>setShowCreateForm(false),children:\"\\xD7\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleCreateSlot,className:\"slot-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"T\\xEDtulo (opcional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:formData.titulo,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{titulo:e.target.value})),placeholder:\"Ej: Almuerzo especial\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Descripci\\xF3n (opcional)\"}),/*#__PURE__*/_jsx(\"textarea\",{value:formData.descripcion,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{descripcion:e.target.value})),placeholder:\"Describe qu\\xE9 incluye esta franja\",rows:3})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Fecha *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:formData.fecha,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{fecha:e.target.value})),required:true,min:new Date().toISOString().split('T')[0]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Capacidad *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:formData.capacidad,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{capacidad:parseInt(e.target.value)})),min:\"1\",max:\"100\",required:true})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Hora Inicio *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:formData.hora_inicio,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{hora_inicio:e.target.value})),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Hora Fin *\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:formData.hora_fin,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{hora_fin:e.target.value})),required:true})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Precio por unidad (opcional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:formData.precio_descuento,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{precio_descuento:parseFloat(e.target.value)||0})),min:\"0\",step:\"100\",placeholder:\"0\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowCreateForm(false),children:\"Cancelar\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"primary\",children:\"Crear Franja\"})]})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"slots-content\",children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Cargando franjas...\"}):slots.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(Clock,{size:48}),/*#__PURE__*/_jsx(\"h3\",{children:\"No tienes franjas horarias\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Crea tu primera franja para que los clientes puedan reservar\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"create-first-btn\",onClick:()=>setShowCreateForm(true),children:[/*#__PURE__*/_jsx(Plus,{size:20}),\"Crear Primera Franja\"]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"slots-grid\",children:slots.map(slot=>/*#__PURE__*/_jsxs(\"div\",{className:\"slot-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"slot-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"slot-title\",children:slot.titulo||'Franja Horaria'}),/*#__PURE__*/_jsx(\"div\",{className:\"slot-status\",style:{color:getStatusColor(slot)},children:getStatusText(slot)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"slot-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(Calendar,{size:16}),/*#__PURE__*/_jsx(\"span\",{children:formatDate(slot.fecha)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(Clock,{size:16}),/*#__PURE__*/_jsxs(\"span\",{children:[formatTime(slot.hora_inicio),\" - \",formatTime(slot.hora_fin)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(Users,{size:16}),/*#__PURE__*/_jsxs(\"span\",{children:[slot.disponible,\" / \",slot.capacidad,\" disponibles\"]})]})]}),slot.descripcion&&/*#__PURE__*/_jsx(\"div\",{className:\"slot-description\",children:slot.descripcion}),slot.precio_descuento>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"slot-price\",children:[\"$\",slot.precio_descuento.toLocaleString(),\" por unidad\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"slot-actions\",children:slot.activo&&slot.disponible>0&&/*#__PURE__*/_jsxs(\"button\",{className:\"close-slot-btn\",onClick:()=>handleCloseSlot(slot.id),children:[/*#__PURE__*/_jsx(EyeOff,{size:16}),\"Cerrar Franja\"]})})]},slot.id))})})]});};export default MerchantSlots;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}