{"ast":null,"code":"import _objectSpread from\"C:/Users/PERSONAL/Downloads/tugood tugo/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{ArrowLeft,User,CreditCard,Bell,MapPin,LogOut,Edit2,ChevronRight,Leaf,DollarSign,Utensils}from'lucide-react';import{usersAPI,pagosAPI}from'../services/api';import'../styles/Profile.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Profile=_ref=>{let{user,onLogout}=_ref;const navigate=useNavigate();const[editingProfile,setEditingProfile]=useState(false);const[profileData,setProfileData]=useState({name:(user===null||user===void 0?void 0:user.name)||'Usuario',email:(user===null||user===void 0?void 0:user.email)||'',phone:''});const[loading,setLoading]=useState(true);const[saving,setSaving]=useState(false);const[paymentMethods,setPaymentMethods]=useState([]);const[impactStats,setImpactStats]=useState({foodSaved:0,// kg de comida salvada\nmoneySaved:0,// dinero ahorrado en COP\nco2Reduced:0// kg de CO2 reducido\n});const[preferences,setPreferences]=useState({notifications:true,emailUpdates:false,smsUpdates:true,favoriteZones:['Chapinero','Zona Rosa']});// Load user profile and payment methods\nuseEffect(()=>{const loadProfileData=async()=>{try{setLoading(true);// Load user profile\nconst profile=await usersAPI.getProfile();setProfileData({name:profile.user.nombre,email:profile.user.email,phone:profile.user.telefono||'300-000-0000',city:profile.user.ciudad||'Bogotá'});const methods=await pagosAPI.getPaymentMethods();setPaymentMethods(methods.metodos||[]);// Calculate impact statistics (mock data for now)\n// En una implementación real, esto vendría de una API de estadísticas\nconst totalOrders=Math.floor(Math.random()*50)+10;// 10-60 pedidos\nconst avgPackWeight=0.8;// kg promedio por pack\nconst avgSavings=12000;// COP promedio ahorrado por pack\nconst co2PerKg=2.5;// kg CO2 por kg de comida salvada\nsetImpactStats({foodSaved:Math.round(totalOrders*avgPackWeight*10)/10,// Redondear a 1 decimal\nmoneySaved:totalOrders*avgSavings,co2Reduced:Math.round(totalOrders*avgPackWeight*co2PerKg*10)/10});}catch(err){console.error('Error loading profile:',err);}finally{setLoading(false);}};loadProfileData();},[]);const handleProfileUpdate=async()=>{try{setSaving(true);const updateData={nombre:profileData.name,telefono:profileData.phone};await usersAPI.updateProfile(updateData);setEditingProfile(false);}catch(err){console.error('Error updating profile:',err);alert('Error actualizando perfil');}finally{setSaving(false);}};const handlePreferenceChange=(key,value)=>{setPreferences(prev=>_objectSpread(_objectSpread({},prev),{},{[key]:value}));};const handleSwitchToMerchant=()=>{if(window.confirm('¿Quieres cambiar tu cuenta a tipo Comercio? Podrás vender excedentes de comida.')){// Actualizar el tipo de usuario en localStorage\nconst currentUser=JSON.parse(localStorage.getItem('tugood_user')||'{}');const updatedUser=_objectSpread(_objectSpread({},currentUser),{},{tipo:'comercio'});localStorage.setItem('tugood_user',JSON.stringify(updatedUser));alert('¡Cuenta cambiada a Comercio exitosamente! Recarga la página para ver los cambios.');window.location.reload();}};const handleLogout=()=>{if(window.confirm('¿Estás seguro de que quieres cerrar sesión?')){// Clear localStorage\nlocalStorage.removeItem('tugood_token');localStorage.removeItem('tugood_cart');localStorage.removeItem('tugood_user');if(onLogout){onLogout();}else{// Fallback: reload page to trigger auth check\nwindow.location.reload();}}};const handleAddPaymentMethod=()=>{// TODO: Implement add payment method modal\nalert('Funcionalidad de agregar método de pago próximamente');};const handleEditZones=()=>{// TODO: Implement edit favorite zones\nalert('Funcionalidad de editar zonas favoritas próximamente');};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"profile-screen\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Cargando perfil...\"})]})})});}return/*#__PURE__*/_jsx(\"div\",{className:\"profile-screen\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-button\",onClick:()=>navigate(-1),children:/*#__PURE__*/_jsx(ArrowLeft,{size:24})}),/*#__PURE__*/_jsx(\"h1\",{children:\"Perfil\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Informaci\\xF3n Personal\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"edit-button\",onClick:()=>setEditingProfile(!editingProfile),children:[/*#__PURE__*/_jsx(Edit2,{size:16}),editingProfile?'Cancelar':'Editar']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-info-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"user-avatar\",children:/*#__PURE__*/_jsx(User,{size:32})}),/*#__PURE__*/_jsx(\"div\",{className:\"user-details\",children:editingProfile?/*#__PURE__*/_jsxs(\"div\",{className:\"edit-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:profileData.name,onChange:e=>setProfileData(_objectSpread(_objectSpread({},profileData),{},{name:e.target.value})),className:\"edit-input\",placeholder:\"Nombre completo\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",value:profileData.email,onChange:e=>setProfileData(_objectSpread(_objectSpread({},profileData),{},{email:e.target.value})),className:\"edit-input\",placeholder:\"Correo electr\\xF3nico\"}),/*#__PURE__*/_jsx(\"input\",{type:\"tel\",value:profileData.phone,onChange:e=>setProfileData(_objectSpread(_objectSpread({},profileData),{},{phone:e.target.value})),className:\"edit-input\",placeholder:\"Tel\\xE9fono\"}),/*#__PURE__*/_jsx(\"button\",{className:\"save-button\",onClick:handleProfileUpdate,disabled:saving,children:saving?'Guardando...':'Guardar cambios'})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h3\",{children:profileData.name}),/*#__PURE__*/_jsx(\"p\",{children:profileData.email}),/*#__PURE__*/_jsx(\"p\",{children:profileData.phone})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-header\",children:/*#__PURE__*/_jsx(\"h2\",{children:\"Tu Impacto Ambiental\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"impact-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"impact-card food-saved\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"impact-icon\",children:/*#__PURE__*/_jsx(Utensils,{size:24})}),/*#__PURE__*/_jsxs(\"div\",{className:\"impact-content\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[impactStats.foodSaved,\" kg\"]}),/*#__PURE__*/_jsx(\"p\",{children:\"Comida salvada\"}),/*#__PURE__*/_jsx(\"span\",{className:\"impact-description\",children:\"Evitaste que esta comida fuera desperdiciada\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"impact-card money-saved\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"impact-icon\",children:/*#__PURE__*/_jsx(DollarSign,{size:24})}),/*#__PURE__*/_jsxs(\"div\",{className:\"impact-content\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"$\",impactStats.moneySaved.toLocaleString('es-CO')]}),/*#__PURE__*/_jsx(\"p\",{children:\"Dinero ahorrado\"}),/*#__PURE__*/_jsx(\"span\",{className:\"impact-description\",children:\"Ahorro total en tus compras\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"impact-card co2-reduced\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"impact-icon\",children:/*#__PURE__*/_jsx(Leaf,{size:24})}),/*#__PURE__*/_jsxs(\"div\",{className:\"impact-content\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[impactStats.co2Reduced,\" kg\"]}),/*#__PURE__*/_jsx(\"p\",{children:\"CO\\u2082 reducido\"}),/*#__PURE__*/_jsx(\"span\",{className:\"impact-description\",children:\"Emisiones evitadas al salvar comida\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"M\\xE9todos de Pago\"}),/*#__PURE__*/_jsx(\"button\",{className:\"add-button\",onClick:handleAddPaymentMethod,children:\"+ Agregar\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"payment-methods\",children:paymentMethods.length>0?paymentMethods.map(method=>/*#__PURE__*/_jsxs(\"div\",{className:\"payment-method-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"payment-icon\",children:/*#__PURE__*/_jsx(CreditCard,{size:20})}),/*#__PURE__*/_jsxs(\"div\",{className:\"payment-details\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"payment-type\",children:method.nombre}),/*#__PURE__*/_jsx(\"span\",{className:\"payment-desc\",children:method.descripcion})]}),/*#__PURE__*/_jsx(ChevronRight,{size:16})]},method.id)):/*#__PURE__*/_jsx(\"div\",{className:\"empty-payment-methods\",children:/*#__PURE__*/_jsx(\"p\",{children:\"No tienes m\\xE9todos de pago guardados\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-header\",children:/*#__PURE__*/_jsx(\"h2\",{children:\"Preferencias\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"preferences\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"preference-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"preference-info\",children:[/*#__PURE__*/_jsx(Bell,{size:20}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Notificaciones push\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Recibe alertas de nuevas ofertas\"})]})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"toggle\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:preferences.notifications,onChange:e=>handlePreferenceChange('notifications',e.target.checked)}),/*#__PURE__*/_jsx(\"span\",{className:\"toggle-slider\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"preference-item\",onClick:handleEditZones,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"preference-info\",children:[/*#__PURE__*/_jsx(MapPin,{size:20}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Zonas favoritas\"}),/*#__PURE__*/_jsx(\"p\",{children:preferences.favoriteZones.join(', ')})]})]}),/*#__PURE__*/_jsx(ChevronRight,{size:16})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"preference-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"preference-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"icon-placeholder\",children:\"\\uD83D\\uDCE7\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Correos promocionales\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Recibe ofertas especiales por email\"})]})]}),/*#__PURE__*/_jsxs(\"label\",{className:\"toggle\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:preferences.emailUpdates,onChange:e=>handlePreferenceChange('emailUpdates',e.target.checked)}),/*#__PURE__*/_jsx(\"span\",{className:\"toggle-slider\"})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-header\",children:/*#__PURE__*/_jsx(\"h2\",{children:\"Tipo de Cuenta\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"account-type-info\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"current-type\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"type-badge\",children:(user===null||user===void 0?void 0:user.tipo)==='comercio'?'🏪 Comercio':'🛒 Cliente'}),/*#__PURE__*/_jsx(\"p\",{children:(user===null||user===void 0?void 0:user.tipo)==='comercio'?'Puedes vender excedentes de comida':'Puedes comprar packs de comida'})]}),(user===null||user===void 0?void 0:user.tipo)==='cliente'&&/*#__PURE__*/_jsx(\"button\",{className:\"switch-account-btn\",onClick:()=>handleSwitchToMerchant(),children:\"\\uD83C\\uDFEA Cambiar a Comercio\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-section\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-header\",children:/*#__PURE__*/_jsx(\"h2\",{children:\"Informaci\\xF3n\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-items\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"T\\xE9rminos y condiciones\"}),/*#__PURE__*/_jsx(ChevronRight,{size:16})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Pol\\xEDtica de privacidad\"}),/*#__PURE__*/_jsx(ChevronRight,{size:16})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Ayuda y soporte\"}),/*#__PURE__*/_jsx(ChevronRight,{size:16})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-item\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Versi\\xF3n de la app\"}),/*#__PURE__*/_jsx(\"span\",{className:\"version\",children:\"1.0.0\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-section\",children:/*#__PURE__*/_jsxs(\"button\",{className:\"logout-button\",onClick:handleLogout,children:[/*#__PURE__*/_jsx(LogOut,{size:20}),\"Cerrar sesi\\xF3n\"]})})]})]})});};export default Profile;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}