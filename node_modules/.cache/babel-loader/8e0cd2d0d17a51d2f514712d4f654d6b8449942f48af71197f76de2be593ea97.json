{"ast":null,"code":"import _taggedTemplateLiteral from\"C:/Users/PERSONAL/Downloads/tugood tugo/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject0;import React,{useState,useEffect}from'react';import styled from'styled-components';import{toast}from'react-toastify';import{Mail,ArrowLeft,Loader2}from'lucide-react';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const OTPVerification=_ref=>{let{email,onBack,onSuccess}=_ref;const[otp,setOtp]=useState(['','','','','','']);const[isLoading,setIsLoading]=useState(false);const[countdown,setCountdown]=useState(60);const[canResend,setCanResend]=useState(false);const navigate=useNavigate();// Efecto para el contador de reenvío\nuseEffect(()=>{let timer;if(countdown>0){timer=setTimeout(()=>setCountdown(countdown-1),1000);}else{setCanResend(true);}return()=>clearTimeout(timer);},[countdown]);const handleOtpChange=(element,index)=>{if(isNaN(element.value))return false;const newOtp=[...otp];newOtp[index]=element.value;setOtp(newOtp);// Auto-focus al siguiente campo\nif(element.nextSibling&&element.value!==''){element.nextSibling.focus();}};const handleKeyDown=(e,index)=>{if(e.key==='Backspace'&&e.target.value===''&&index>0){// Mover al campo anterior al presionar retroceso\nconst prevInput=e.target.previousSibling;if(prevInput){prevInput.focus();}}};const handleVerify=async e=>{e.preventDefault();const otpCode=otp.join('');if(otpCode.length!==6){toast.error('Por favor ingresa el código de 6 dígitos');return;}setIsLoading(true);try{const response=await fetch('http://localhost:5000/api/otp/verify',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email,otp:otpCode})});const data=await response.json();if(response.ok){toast.success('¡Código verificado con éxito!');if(onSuccess){onSuccess(data.token);// Asegúrate de que el backend devuelva un token\n}}else{toast.error(data.message||'Error al verificar el código');}}catch(error){console.error('Error al verificar el código:',error);toast.error('Error de conexión. Intenta de nuevo más tarde.');}finally{setIsLoading(false);}};const handleResendCode=async()=>{if(!canResend)return;setIsLoading(true);try{const response=await fetch('http://localhost:5000/api/otp/request',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email})});const data=await response.json();if(response.ok){var _document$getElementB;toast.success('¡Código reenviado con éxito!');setCountdown(60);setCanResend(false);setOtp(['','','','','','']);// Enfocar el primer campo del OTP\n(_document$getElementB=document.getElementById('otp-0'))===null||_document$getElementB===void 0?void 0:_document$getElementB.focus();}else{toast.error(data.message||'Error al reenviar el código');}}catch(error){console.error('Error al reenviar el código:',error);toast.error('Error de conexión. Intenta de nuevo más tarde.');}finally{setIsLoading(false);}};return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsxs(BackButton,{onClick:onBack,children:[/*#__PURE__*/_jsx(ArrowLeft,{size:20}),\" Volver\"]}),/*#__PURE__*/_jsx(IconContainer,{children:/*#__PURE__*/_jsx(Mail,{size:48,color:\"#4F46E5\"})}),/*#__PURE__*/_jsx(Title,{children:\"Verifica tu correo\"}),/*#__PURE__*/_jsxs(Description,{children:[\"Hemos enviado un c\\xF3digo de 6 d\\xEDgitos a \",/*#__PURE__*/_jsx(\"strong\",{children:email}),\". Por favor, ingr\\xE9salo a continuaci\\xF3n para continuar.\"]}),/*#__PURE__*/_jsx(OTPContainer,{children:otp.map((digit,index)=>/*#__PURE__*/_jsx(OTPInput,{id:\"otp-\".concat(index),type:\"text\",maxLength:\"1\",value:digit,onChange:e=>handleOtpChange(e.target,index),onKeyDown:e=>handleKeyDown(e,index),autoFocus:index===0,disabled:isLoading},index))}),/*#__PURE__*/_jsx(Button,{onClick:handleVerify,disabled:isLoading,children:isLoading?/*#__PURE__*/_jsx(Loader2,{size:20,className:\"animate-spin\"}):'Verificar código'}),/*#__PURE__*/_jsxs(ResendText,{children:[\"\\xBFNo recibiste el c\\xF3digo?\",' ',/*#__PURE__*/_jsx(ResendButton,{onClick:handleResendCode,disabled:!canResend||isLoading,children:canResend?'Reenviar código':\"Reenviar en \".concat(countdown,\"s\")})]})]});};const Container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  max-width: 400px;\\n  margin: 0 auto;\\n  padding: 2rem;\\n  text-align: center;\\n\"])));const BackButton=styled.button(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  gap: 0.5rem;\\n  background: none;\\n  border: none;\\n  color: #6B7280;\\n  font-size: 0.875rem;\\n  cursor: pointer;\\n  margin-bottom: 1.5rem;\\n  padding: 0.5rem;\\n  border-radius: 0.375rem;\\n  transition: background-color 0.2s;\\n  \\n  &:hover {\\n    background-color: #F3F4F6;\\n  }\\n\"])));const IconContainer=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: center;\\n  margin-bottom: 1.5rem;\\n\"])));const Title=styled.h1(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  font-size: 1.5rem;\\n  font-weight: 600;\\n  color: #111827;\\n  margin-bottom: 0.75rem;\\n\"])));const Description=styled.p(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  color: #6B7280;\\n  margin-bottom: 2rem;\\n  line-height: 1.5;\\n\"])));const OTPContainer=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: space-between;\\n  margin-bottom: 2rem;\\n  gap: 0.75rem;\\n\"])));const OTPInput=styled.input(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  width: 3.5rem;\\n  height: 3.5rem;\\n  text-align: center;\\n  font-size: 1.5rem;\\n  border: 1px solid #D1D5DB;\\n  border-radius: 0.5rem;\\n  outline: none;\\n  transition: border-color 0.2s, box-shadow 0.2s;\\n  \\n  &:focus {\\n    border-color: #4F46E5;\\n    box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.2);\\n  }\\n  \\n  &::placeholder {\\n    color: #9CA3AF;\\n  }\\n  \\n  &:disabled {\\n    background-color: #F3F4F6;\\n    cursor: not-allowed;\\n  }\\n\"])));const Button=styled.button(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  width: 100%;\\n  padding: 0.875rem;\\n  background-color: #4F46E5;\\n  color: white;\\n  font-weight: 500;\\n  border: none;\\n  border-radius: 0.5rem;\\n  font-size: 1rem;\\n  cursor: pointer;\\n  transition: background-color 0.2s;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  gap: 0.5rem;\\n  \\n  &:hover {\\n    background-color: #4338CA;\\n  }\\n  \\n  &:disabled {\\n    background-color: #A5B4FC;\\n    cursor: not-allowed;\\n  }\\n\"])));const ResendText=styled.p(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  margin-top: 1.5rem;\\n  color: #6B7280;\\n  font-size: 0.875rem;\\n\"])));const ResendButton=styled.button(_templateObject0||(_templateObject0=_taggedTemplateLiteral([\"\\n  background: none;\\n  border: none;\\n  color: #4F46E5;\\n  font-weight: 500;\\n  cursor: pointer;\\n  padding: 0.25rem 0.5rem;\\n  border-radius: 0.375rem;\\n  font-size: 0.875rem;\\n  \\n  &:hover {\\n    text-decoration: underline;\\n  }\\n  \\n  &:disabled {\\n    color: #9CA3AF;\\n    cursor: not-allowed;\\n    text-decoration: none;\\n  }\\n\"])));export default OTPVerification;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}